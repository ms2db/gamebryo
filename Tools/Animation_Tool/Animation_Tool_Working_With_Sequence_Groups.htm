<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
 "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>

<title>Working with sequence groups in the Animation Tool</title>
<!--(Begin Meta)===================================================-->

<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta name="Originator" content="Pre-Expedition-RH" />
<meta name="Generator" content="Palimpsest by Emergent Game Technologies - http://emergent.net" />
<meta name="Last-Updated" content="%lastupdated%" />

<!--(End Meta)====================================================-->
    
<!--(Begin Links)===================================================-->
    
<link rel="stylesheet" href="../../shared/Emergent.css" type="text/css" />

<!--(End Links)=====================================================-->

</head>

<!--(Begin Body)===================================================-->
<body lang="EN-US">
<script src="../../shared/NavScript.js" language="JavaScript1.2" type="text/javascript"></script> <script language="JavaScript1.2" type="text/javascript">WriteNavLink(2);</script>

<h1>Working with sequence groups in the Animation Tool</h1>

<p>You can use the Animation Tool to set up sequence groups. You can use sequence groups to mix multiple animation sequences simultaneously. You can use these groups to preview what different sequences will look like when they are activated at the same time. Sequence groups are also useful to the programmers with whom you collaborate. Information in sequence groups can guide programmers when they are activating and deactivating sequences in their application.</p>

<p class="NDLHeadingProcedure">To add or modify sequence groups</p>

<ol>

	<li>Launch the Animation Tool and load a .KFM file that you want to work with. For example:

	<p class="indent1"><span class="NDLSystemFont"><em>%EMERGENT_PATH%</em>\Samples\Models\AnimationToolExamples\Tutorials\Tutorial3.kfm</span></p>
	</li>
	
	<li>In the Project View, select <span class="NDLGUILabel">Sequence Groups</span>.</li>

	<li>In the Edit View, click the <span class="NDLGUILabel">Create Sequence Group</span> button.

    <div class="FigureContainer">
        <img src="./images/4_1_SequenceGroupsEditView.jpg" width="309" height="116"
    />
        <!-- <p class="FigureCaption">{Figure caption}</p> -->
    </div>
	</li>
	
	<li>In the Project View, rename the new sequence group that appears in the tree. If you are working with the <span class="NDLSystemFont">Tutorial3.kfm</span> sample, name the sequence group "idle" and press Enter. Select it the sequence group in the Project 
 View if it is not already selected.

    <div class="FigureContainer">
        <img src="./images/4_2_EditingIdleProjectView.jpg" width="300" height="551"
    />
        <!-- <p class="FigureCaption">{Figure caption}</p> -->
    </div>
		
	<p class="indent1">Take a look at the Edit View again. Note that the Sequence Group is currently empty.</p>

    <div class="FigureContainer">
        <img src="./images/4_3_EmptyEditView.jpg" width="307" height="657"
    />
        <!-- <p class="FigureCaption">{Figure caption}</p> -->
    </div>
	</li>
	
	<li>Click the <span class="NDLGUILabel">+</span> button and double-click a sequence in the <span class="NDLGUILabel">Available Sequences</span> list to add it to the sequence group. If you are working with the <span class="NDLSystemFont">Tutorial3.kfm</span> sample, double-click "idle01_right". Click <span class="NDLGUILabel">OK</span>.

	<p class="indent1">You should now see the sequence that you selected animating in the Render View.</p>

    <div class="FigureContainer">
        <img src="./images/4_4_AddingIdleRight.jpg" width="400" height="344"
    />
        <!-- <p class="FigureCaption">{Figure caption}</p> -->
    </div>
	</li>
	
	<li>You can also add sequences by dragging them from their location in the Project View tree. Try dragging a sequence to your sequence group now. If you're working with the sample, drag "idle01_Left" onto the "idle" sequence group. (You cannot drag items from the Project View to the Edit View.)</li>

	<li>Note that the sequences that you added to your sequence group are classified as active in the <span class="NDLGUILabel">Active Status of Sequences</span> section of the Edit View. For example, if you're using the sample, the" idle01_right" and "idle01_Left" sequences are active. The animation is facing forward, even though both sequences are rotated to either the left or right.

    <div class="FigureContainer">
        <img src="./images/4_5_AllActive.jpg" width="969" height="647"
    />
        <!-- <p class="FigureCaption">{Figure caption}</p> -->
    </div>
	</li>
	
	<li>In the <span class="NDLGUILabel">Active Status of Sequences</span> section of the Edit View, uncheck the checkbox beside one of the sequences. This will deactivate that sequence and the Render View will update to display only the remaining active sequence. If you're using the <span class="NDLSystemFont">Tutorial3.kfm</span> sample, turn off "idle01_right" by clicking its checkbox. In the Render View, watch the animation blend to just playing the "idle01_Left" sequence.

    <div class="FigureContainer">
        <img src="./images/4_6_UncheckIdleRight.jpg" width="967" height="647"
    />
        <!-- <p class="FigureCaption">{Figure caption}</p> -->
    </div>
	</li>
	
	<li>Re-activate the sequence that you de-activated in the previous step.</li>
	
	<li>In the <span class="NDLGUILabel">Active Status of Sequences</span> section of the Edit View, click the <span class="NDLGUILabel">Weight</span> cell beside one of the sequences ("idle01_right" in the sample). The <span class="NDLGUILabel">Weight</span> cell now includes a slider that you can use to adjust the sequence's weight. Drag the slider to halfway. This sets the weight of the sequence in the sequence group to approximately 0.5. If you're working with the sample, you can note that the Render View adjusts the playback to match the weights as you adjust the slider. By reducing the effect of "idle01_right," the character will be weighted more heavily toward his "idle01_Left" animation sequence.

    <div class="FigureContainer">
        <img src="./images/4_7_IdleRightWeight.jpg" width="970" height="646"
    />
        <!-- <p class="FigureCaption">{Figure caption}</p> -->
    </div>
	</li>
	
	<li>In the <span class="NDLGUILabel">Active Status of Sequences</span> section of the Edit View, click the other sequence ("idle01_Left" in the sample.) The <span class="NDLGUILabel">Properties</span> panel updates with the values for the selected sequence. Adjust the <span class="NDLGUILabel">Weight %</span> value to .25. This has the same effect as dragging the slider in the table. If you're using the sample, note that the character is now favoring his "idle01_right" animation. This is because the "idle01_right" sequence has a higher weight than "idle01_Left."

    <div class="FigureContainer">
        <img src="./images/4_8_IdleLeftWeight.jpg" width="966" height="646"
    />
        <!-- <p class="FigureCaption">{Figure caption}</p> -->
    </div>
	</li>
	
	<li>In the <span class="NDLGUILabel">Properties</span> section of the Edit View, you can experiment by adjusting the speed at which the sequences are activated and deactivated. As you make changes in the <span class="NDLGUILabel">Ease-In</span> and <span class="NDLGUILabel">Ease-Out</span> fields, the engine slowly ramps the weights to their final value to create a smooth blend. If you're working with the sample, change the <span class="NDLGUILabel">Ease-In</span> field to 0.5 seconds and change <span class="NDLGUILabel">Ease-Out</span> field to 0.5 seconds. Now deactivate "idle01_Left" by clicking the checkbox in the table. Notice that it now takes longer for "idle01_Left" to disappear from the blend. Reactivate the sequence and notice that it also takes longer for "idle01_Left" to reach its final effect in the blend.</li>

	<li>In the Edit View, click the <span class="NDLGUILabel">+</span> button to open the <span class="NDLGUILabel">Keystroke Settings</span> section.</li>

	<li>Double-click the Keystroke entry for one of your sequences ("idle01_Left" in the <span class="NDLSystemFont">Tutorial3.kfm</span> sample) and then press the Left arrow key. Note that this sets the entry in the table to "Left". Set the other sequence's key to the Right arrow.


    <div class="FigureContainer">
        <img src="./images/4_9_KeystrokeBindings.jpg" width="306" height="754"
    />
        <!-- <p class="FigureCaption">{Figure caption}</p> -->
    </div>
	</li>
	
	<li>Test the keystroke settings that you just defined. Click in the Render 
 View and press and release one of the keys that you set in the previous step. For example, if you're using the <span class="NDLSystemFont">Tutorial3.kfm</span> sample, press and release the Left arrow key to toggle "idle01_Left" ON/OFF. (Unlike the Interactive Preview, the Sequence Group keystrokes are toggles and do not need to be held down to keep a sequence active.)</li>

	<li>Create a new sequence group by right-clicking <span class="NDLGUILabel">Sequence Group</span> in the Project View and selecting <span class="NDLGUILabel">Create New Sequence Group</span> from the context menu. Name the sequence group (name it "walk/fire" if you're using the sample.)

    <div class="FigureContainer">
        <img src="./images/4_10_RightClickCreate.jpg" width="301" height="553"
    />
        <!-- <p class="FigureCaption">{Figure caption}</p> -->
    </div>
	</li>
	
	<li>Add sequences to your new sequence group (see step 5 above). If you are working with the <span class="NDLSystemFont">Tutorial3.kfm</span> sample, add the "walk" and "upper_fire_front" sequences to the "walk/fire" sequence group.</li>

	<li>If you're using the sample, watch the animation playback and note the jerkiness of the animation. This is because both "walk" and "upper_fire_front" share several evaluators in common in the hierarchy. These evaluators are located below the spine in the hierarchy of the character. The movements in each sequence are so dramatically different that blending them results in jerky movement.

    <div class="FigureContainer">
        <img src="./images/4_11_WalkFire.jpg" width="970" height="646"
    />
        <!-- <p class="FigureCaption">{Figure caption}</p> -->
    </div>
	</li>
	
	<li>You can resolve any jerkiness in your animation by adjusting the priority of the sequences. The priority of a sequence determines which set of sequences are active on a scene object. Only sequences of the highest priority are blended together on a scene object. If you are working with the <span class="NDLSystemFont">Tutorial3.kfm</span> sample, select "upper fire" from the <span class="NDLGUILabel">Active Status of Sequences</span> panel in the Edit View. In the <span class="NDLGUILabel">Properties</span> panel, change the priority value to 1. Note that this gives control of the upper body completely over to the "upper_fire_front" sequence.

    <div class="FigureContainer">
        <img src="./images/4_12_Priority.jpg" width="971" height="647"
    />
        <!-- <p class="FigureCaption">{Figure caption}</p> -->
    </div>
	</li>
	
	<li>Adjust the <span class="NDLGUILabel">Ease-In</span> and <span class="NDLGUILabel">Ease-Out</span> values as necessary. If you're using the sample, change both values to 0.5 seconds.</li>

	<li>Turn off the active sequence ("upper_fire_front" in the sample). Notice that the engine smoothly blends the sequence out. Turn the sequence back on and watch the animation ease in.</li>

	<li>Create a new sequence group and add three sequences to it. If you are working with the <span class="NDLSystemFont">Tutorial3.kfm</span> sample, call the new sequence group "fire" and add the following sequences to it:

    <ul>
      <li>upper_fire_down</li>
      <li>upper_fire_up</li>
      <li>idle01_fronT</li>
    </ul>
	</li>
	
	<li>Change the priority of two of your group's sequences. If you're working with the sample, change the "upper_fire_down" and "upper_fire_up" sequences' priority to 1.

    <div class="FigureContainer">
        <img src="./images/4_13_Fire.jpg" width="967" height="646"
    />
        <!-- <p class="FigureCaption">{Figure caption}</p> -->
    </div>
	</li>
	
	<li>Watch the animation playback. If you're using the sample, the firing sequences appear to be synchronized, but this is an illusion. The durations of the sequences match and they were both activated at the same time. Disable the "upper_fire_down" sequence and then enable it again. Notice the oddities in animation playback now that both sequences were not activated at the same time.</li>

	<li>Now you can try synchronizing two of your sequences. Select one of your sequences ("upper_fire_up" in the sample) in the <span class="NDLGUILabel">Active Status of Sequences</span> section and then select another sequence ("upper_fire_down" in the sample) in the <span class="NDLGUILabel">Synchronized To</span> field within the <span class="NDLGUILabel">Properties</span> section. In the sample, these two animation sequences can be synchronized because they both share common "morph:" text keys. Note that the animations are now in sync.

    <div class="FigureContainer">
        <img src="./images/4_14_SyncTo.jpg" width="309" height="653"
    />
        <!-- <p class="FigureCaption">{Figure caption}</p> -->
    </div>
	</li>
	
	<li>Adjust the weights to see the effect of blending between your sequences.</li>

	<li>Save the file.</li>
</ol>	

<p class="NDLHeadingRelatedTopic">Related topics</p>
	
<ul>
  <li><a HREF="Introduction_to_Animation_Blending.htm">Introduction to Animation Blending</a></li>
  <li><a HREF="Sequence_Groups.htm">Sequence Groups</a></li>
  <li><a HREF="Animation_Tool_Samples.htm">Animation Tool Samples</a></li>
</ul>


<!--kadov_tag{{<placeholder id="footer">}}-->

</body>

</html>
