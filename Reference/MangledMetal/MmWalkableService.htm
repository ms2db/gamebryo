<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
 "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>

<title>MmWalkableService</title>
<!--(Begin Meta)================================================================================-->

<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta name="Originator" content="Expedition" />
<meta name="Generator" content="DoxyConvert by Emergent Game Technologies - http://emergent.net" />

<meta name="Last-Updated" content="%lastupdated%" />

<!--(End Meta)==================================================================================-->
    
<!--(Begin Links)===============================================================================-->

<link rel="stylesheet" href="../../shared/Emergent.css" type="text/css" />

<!--(End Links)=================================================================================-->

</head>
  
<!--(Body)======================================================================================-->
<body lang="EN-US">
<script src="../../shared/NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
<script language="JavaScript1.2" type="text/javascript">WriteNavLink(2);</script>

<p class="NDLRefHeadClassTitle">MmWalkableService</p>
<p class="NDLRefParentage">: public <span class="NDLSystemFont"><a href="../efd/efd__ISystemService.htm">efd::ISystemService</a></span></p>


<p class="NDLRefHeaderFile">&lt;MmWalkableService.h&gt;</p>

<p class="NDLRefHead1" style="text-align: center; ">
<div class="FigureContainer">
  <img src="./images/class_mm_walkable_service.gif" alt="Inheritance graph for MmWalkableService"/>
  <p class="FigureCaption">Inheritance graph for MmWalkableService</p>
</div>
</p>

<p class="NDLRefHead1">Description</p>
<p class="NDLNormal">Helps entities conform to walkable and non-walkable surfaces. </p>
<p class="NDLNormal">This service provides the functionality necessary to make an entity to conform to the height of walkable surfaces or terrain and be blocked and slide around the edges of walkable surfaces, non-walkable surfaces and terrain. It collects references to geometry that follows a naming convention identifying it as walkable or non-walkable and optionally an <span class="NDLSystemFont"><a href="../NiTerrain/NiTerrain.htm">NiTerrain</a></span> object.</p>
<p class="NDLNormal">The service can optionally track material metadata from walk requests and associate that with the requesting entity such that material change notifications can be sent out when the walked on material changes.</p>
<p class="NDLNormal">Walkable and non-walkable surfaces are identified whenever new scenegraphs are created. The walkable service will inspect newly created scenegraphs and find any objects within it named "Walkable" or "NonWalkable" respectively. These objects are cached and recursively picked against to determine success.</p>
<p class="NDLNormal">Terrain material can be used to limit walkability. To do so, attach a float metadata to the material called "NonWalkable". The value of the metadata will be used to determine the walkability threshold for that material on a scale from 0 to 100. Areas where the material has a percent of influence above this threshold will be non-walkable.</p>
<p class="NDLNormal">To associate a walkable surface with a material name, attach an <span class="NDLSystemFont"><a href="../NiMain/NiStringExtraData.htm">NiStringExtraData</a></span> called "MaterialName" with a value of whatever material you want change notifications to be sent for. Similarly, to associate a material with terrain, add a string metadata to your terrain material called "MaterialName" with a value of the material name. </p>

<a name="public_methods"></a>
<p class="NDLRefHead1">Public Methods</p>


<a name="class_mm_walkable_service_1a94dd56d1d510ead5d1367a65ee127d30"></a>
<p class="NDLRefMemberFunction">MmWalkableService()</p>
<p class="NDLRefMemberDetailedDescription">Constructor </p>

<a name="class_mm_walkable_service_1a8b61443c7df4ca2a7398ebcaebca629e"></a>
<p class="NDLRefMemberFunction">virtual void  HandleSceneAddedMessage(<br/>const <span class="NDLSystemFont"><a href="../ecr/ecr__SceneGraphAddedMessage.htm">ecr::SceneGraphAddedMessage</a></span>* pMessage, <br/><span class="NDLSystemFont"><a href="../efd/efd__Category.htm">efd::Category</a></span> targetChannel)</p>
<p class="NDLRefMemberDescription">Checks the new scene for walkable/nonwalkable elements and adds them to the list. </p>

<a name="class_mm_walkable_service_1a78d402215533ca80f1ce39921b014f0b"></a>
<p class="NDLRefMemberFunction">virtual void  HandleSceneRemovedMessage(<br/>const <span class="NDLSystemFont"><a href="../ecr/ecr__SceneGraphRemovedMessage.htm">ecr::SceneGraphRemovedMessage</a></span>* pMessage, <br/><span class="NDLSystemFont"><a href="../efd/efd__Category.htm">efd::Category</a></span> targetChannel)</p>
<p class="NDLRefMemberDescription">Removes walkable/nonwalkable elements for the removed scene. </p>

<a name="class_mm_walkable_service_1a1181456c4bab52f9d78d6d8943d9a19c"></a>
<p class="NDLRefMemberFunction">virtual void  HandleTerrainChangedMessage(<br/>const <span class="NDLSystemFont"><a href="../egmTerrain/egmTerrain__TerrainChangedMessage.htm">egmTerrain::TerrainChangedMessage</a></span>* pMessage, <br/><span class="NDLSystemFont"><a href="../efd/efd__Category.htm">efd::Category</a></span> targetChannel)</p>
<p class="NDLRefMemberDescription">Deals with updates to the terrain, probably due to rapid iteration. </p>

<a name="class_mm_walkable_service_1a1085583e22d1d4ef568e0db8ac6f261c"></a>
<p class="NDLRefMemberFunction"><span class="NDLSystemFont">efd::Bool</span>  Walk(<br/><span class="NDLSystemFont"><a href="../egf/egf__Entity.htm">egf::Entity</a></span>* pEntity, <br/><span class="NDLSystemFont"><a href="../efd/efd__Point3.htm">efd::Point3</a></span> source, <br/><span class="NDLSystemFont"><a href="../efd/efd__Point3.htm">efd::Point3</a></span> goal, <br/><span class="NDLSystemFont"><a href="../efd/efd__Point3.htm">efd::Point3</a></span>& result, <br/><span class="NDLSystemFont"><a href="../Namespaces/efd.htm">efd::SInt32</a></span> callDepth)</p>
<p class="NDLRefMemberDescription">Determines how the given entity can move relative to the scene's walkable surfaces, non-walkable surfaces and terrain. </p>
<p class="NDLRefMemberDetailedDescription"></p>
<!--(Table)=====================================================================================-->
<div class="ReferenceTable">
    <table>
        <thead>
            <tr>
                <th>Parameter</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>  
<tr>
    <td><span class="NDLSystemFont">pEntity</span></td>
    <td>The entity that is attempting to move </td>
</tr>
<tr>
    <td><span class="NDLSystemFont">source</span></td>
    <td>The starting position of that entity </td>
</tr>
<tr>
    <td><span class="NDLSystemFont">goal</span></td>
    <td>The destination position the entity is trying to move to </td>
</tr>
<tr>
    <td><span class="NDLSystemFont">result</span></td>
    <td>The actual destination after being blocked or sliding </td>
</tr>
<tr>
    <td><span class="NDLSystemFont">callDepth</span></td>
    <td>Internally used to limit pick count. Should always be zero when called externally </td>
</tr>
<tr>
    <td><em>Return Value</em></td>
    <td>If no valid walkable results were found, false is returned </td>
</tr>

        </tbody>
    </table>
</div>



<a name="class_mm_walkable_service_1acf05d518925420171291d3ced44c6e65"></a>
<p class="NDLRefMemberFunction">void  SetMaxSlope(<span class="NDLSystemFont"><a href="../Namespaces/efd.htm">efd::Float32</a></span> newSlope)</p>
<p class="NDLRefMemberDescription">Sets the slope threshold beyond which the player will not be able to walk. </p>
<p class="NDLRefMemberDetailedDescription">This parameter is only considered when moving on terrain. Walkable meshes can be walked on at any slope.</p>
<p class="NDLRefMemberDetailedDescription"></p>
<!--(Table)=====================================================================================-->
<div class="ReferenceTable">
    <table>
        <thead>
            <tr>
                <th>Parameter</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>  
<tr>
    <td><span class="NDLSystemFont">newSlope</span></td>
    <td>Slope expressed as a ratio of distance in the pick direction over distance perpendicular to the slope direction. In other words, it is rise over run. </td>
</tr>

        </tbody>
    </table>
</div>



<a name="class_mm_walkable_service_1a28397388a97798a04f711636c3542736"></a>
<p class="NDLRefMemberFunction"><span class="NDLSystemFont"><a href="../Namespaces/efd.htm">efd::Float32</a></span>  GetMaxSlope()</p>
<p class="NDLRefMemberDescription">Retrieve the current slope threshold that will limit movement on terrain. </p>

<a name="class_mm_walkable_service_1ab1f0aaa8241f955d65581b0f34f93b7e"></a>
<p class="NDLRefMemberFunction">void  SetTerrainLODLevel(<span class="NDLSystemFont"><a href="../Namespaces/efd.htm">efd::UInt32</a></span> newLOD)</p>
<p class="NDLRefMemberDescription">Sets the LOD level that is used for terrain testing. </p>
<p class="NDLRefMemberDetailedDescription">Using a finer LOD level can be slightly more expensive and add small jagged edges to the walkable/nonwalkable areas. Using a coarser LOD level can prevent or allow entities from moving into unwanted areas and adds more error to ground conformance.</p>
<p class="NDLRefMemberDetailedDescription"></p>
<!--(Table)=====================================================================================-->
<div class="ReferenceTable">
    <table>
        <thead>
            <tr>
                <th>Parameter</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>  
<tr>
    <td><span class="NDLSystemFont">newLOD</span></td>
    <td>LOD level to use </td>
</tr>

        </tbody>
    </table>
</div>



<a name="class_mm_walkable_service_1a637b2171151ba581adde356885061b58"></a>
<p class="NDLRefMemberFunction"><span class="NDLSystemFont"><a href="../Namespaces/efd.htm">efd::UInt32</a></span>  GetTerrainLODLevel()</p>
<p class="NDLRefMemberDescription">Retrieve the current LOD level used for terrain testing. </p>

<a name="class_mm_walkable_service_1a8c2ad0f7f04f1d8608e3553af8dae3c6"></a>
<p class="NDLRefMemberFunction">void  SetPickHeight(<span class="NDLSystemFont"><a href="../Namespaces/efd.htm">efd::Float32</a></span> newHeight)</p>
<p class="NDLRefMemberDescription">Sets an offset above the given entity's origin to cast the pick from. </p>
<p class="NDLRefMemberDetailedDescription">The offset is always in the exact opposite direction of the pick direction. A positive value is necessary if the entity needs to be able to move up an incline.</p>
<p class="NDLRefMemberDetailedDescription"></p>
<!--(Table)=====================================================================================-->
<div class="ReferenceTable">
    <table>
        <thead>
            <tr>
                <th>Parameter</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>  
<tr>
    <td><span class="NDLSystemFont">newHeight</span></td>
    <td>the new offset from entity origin to use when performing picks </td>
</tr>

        </tbody>
    </table>
</div>



<a name="class_mm_walkable_service_1a5efb26f8b5e470df4c1be1da4f107b68"></a>
<p class="NDLRefMemberFunction"><span class="NDLSystemFont"><a href="../Namespaces/efd.htm">efd::Float32</a></span>  GetPickHeight()</p>
<p class="NDLRefMemberDescription">Retrieve the current pick height used for all walk testing picks. </p>

<a name="class_mm_walkable_service_1a64a5040c87cbc18302758ce24a287ae4"></a>
<p class="NDLRefMemberFunction">void  SetPickDirection(<span class="NDLSystemFont"><a href="../efd/efd__Point3.htm">efd::Point3</a></span> newDirection)</p>
<p class="NDLRefMemberDescription">Sets the direction of all walk testing picks. </p>
<p class="NDLRefMemberDetailedDescription">This should be the opposite of the application's up vector. A typical example for pick direction would be &lt;0, 0, -1&gt;.</p>
<p class="NDLRefMemberDetailedDescription"></p>
<!--(Table)=====================================================================================-->
<div class="ReferenceTable">
    <table>
        <thead>
            <tr>
                <th>Parameter</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>  
<tr>
    <td><span class="NDLSystemFont">newDirection</span></td>
    <td>The pick direction </td>
</tr>

        </tbody>
    </table>
</div>



<a name="class_mm_walkable_service_1ad09b0af4bdec9380d51f25e9a4c13f95"></a>
<p class="NDLRefMemberFunction"><span class="NDLSystemFont"><a href="../efd/efd__Point3.htm">efd::Point3</a></span>  GetPickDirection()</p>
<p class="NDLRefMemberDescription">Retrieve the current pick direction. </p>

<a name="class_mm_walkable_service_1aa4f1952963bf492eefa2d0cee6fe4a28"></a>
<p class="NDLRefMemberFunction">void  SetTrackMaterial(<span class="NDLSystemFont">efd::Bool</span> trackChanges)</p>
<p class="NDLRefMemberDescription">Enable or disable whether the walkable service tracks material changes for each entity that requests walking information. </p>
<p class="NDLRefMemberDetailedDescription">When tracking is enabled, the service will pay attention to any material metadata on picked surfaces and store it. As soon as a different material is detected, a notification will be sent out. The service only tracks entities that make calls to the walk function.</p>
<p class="NDLRefMemberDetailedDescription"></p>
<!--(Table)=====================================================================================-->
<div class="ReferenceTable">
    <table>
        <thead>
            <tr>
                <th>Parameter</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>  
<tr>
    <td><span class="NDLSystemFont">trackChanges</span></td>
    <td>If true, material changes will be tracked </td>
</tr>

        </tbody>
    </table>
</div>



<a name="class_mm_walkable_service_1a352baf005e388803db7afeced1714c8a"></a>
<p class="NDLRefMemberFunction"><span class="NDLSystemFont">efd::Bool</span>  GetTrackMaterial()</p>
<p class="NDLRefMemberDescription">Retrieve whether material changes are currently being tracked. </p>

<a name="class_mm_walkable_service_1ae8b23b0a1d99ff68a4ab1bc27a2d673b"></a>
<p class="NDLRefMemberFunction">void  SetWalkAnywhere(<span class="NDLSystemFont">efd::Bool</span> walkAnywhere)</p>
<p class="NDLRefMemberDescription">Disables the Walk service such that it will always return the indicated goal position without actually testing. </p>

<a name="class_mm_walkable_service_1a2848d252c45d406430cf833c71d80c46"></a>
<p class="NDLRefMemberFunction"><span class="NDLSystemFont">efd::Bool</span>  GetWalkAnywhere()</p>
<p class="NDLRefMemberDescription">Returns the state of the "Walk Anywhere" flag, which disables the walk service. </p>

<a name="class_mm_walkable_service_1a8161a1df2c356ca6427195043efadfdd"></a>
<p class="NDLRefMemberFunction"><span class="NDLSystemFont">efd::Bool</span>  GetCurrentMaterial(<br/><span class="NDLSystemFont"><a href="../egf/egf__Entity.htm">egf::Entity</a></span>* pEntity, <br/><span class="NDLSystemFont"><a href="../NiMain/NiFixedString.htm">NiFixedString</a></span>& materialName)</p>
<p class="NDLRefMemberDescription">When material tracking is enabled this function can be used to query what the currently known material is for any given entity. </p>
<p class="NDLRefMemberDetailedDescription"></p>
<!--(Table)=====================================================================================-->
<div class="ReferenceTable">
    <table>
        <thead>
            <tr>
                <th>Parameter</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>  
<tr>
    <td><span class="NDLSystemFont">pEntity</span></td>
    <td>What Entity to look up the current material for </td>
</tr>
<tr>
    <td><span class="NDLSystemFont">materialName</span></td>
    <td>The material that the given entity was last known to walk on </td>
</tr>
<tr>
    <td><em>Return Value</em></td>
    <td>True if the entity has walked on a material before </td>
</tr>

        </tbody>
    </table>
</div>


 
<!--kadov_tag{{<placeholder id="footer">}}-->

</body>

</html>
